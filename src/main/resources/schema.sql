CREATE TABLE Groups
(
    id   BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(50) UNIQUE
);

CREATE TABLE Universities
(
    id   BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) UNIQUE
);

CREATE TABLE Students
(
    chat_id         BIGINT PRIMARY KEY,
    name            VARCHAR(255),
    surname         VARCHAR(255),
    father_name     VARCHAR(255),
    university_name VARCHAR(100) REFERENCES Universities (name),
    group_name      VARCHAR(50) REFERENCES Groups (name)
);

CREATE TABLE Disciplines
(
    id   BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) UNIQUE
);

CREATE TABLE Tests
(
    test_id       BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    test_name     VARCHAR(100),
    discipline_name VARCHAR(100) REFERENCES Disciplines (name)
);

CREATE TABLE Discipline_Groups
(
    discipline_group_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    discipline_id       BIGINT REFERENCES Disciplines (id),
    group_id            BIGINT REFERENCES Groups (id)
);

CREATE TABLE Questions
(
    id            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    question_text TEXT NOT NULL
);
CREATE TABLE Answers
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    question_id BIGINT REFERENCES Questions (id),
    answer      TEXT,
    correct     BOOLEAN DEFAULT FALSE
);

CREATE TABLE Test_Questions
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    test_id     BIGINT REFERENCES Tests (test_id),
    question_id BIGINT REFERENCES Questions (id)
);
CREATE TABLE Results
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id     BIGINT REFERENCES Students (chat_id),
    test_id     BIGINT REFERENCES Tests (test_id),
    question_id BIGINT REFERENCES Questions (id),
    answer      TEXT NOT NULL
);
CREATE TABLE Users
(
    id       BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    fullname TEXT NOT NULL,
    description TEXT,
    password TEXT NOT NULL,
    email    TEXT NOT NULL,
    role     TEXT
);
CREATE TABLE Users_Groups
(
    id       BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    group_id BIGINT REFERENCES Groups (id),
    user_id  BIGINT REFERENCES Users (id) ON DELETE CASCADE
);





